<div class="mt-0 ml-0 max-h-screen overflow-y-auto">
  <div class="mx-auto p-4">
    <div class="flex justify-between">
      <div class="mb-4 flex justify-end space-x-2">
        <button title="Grade" class="bg-gray-200 hover:bg-gray-300 text-sm w-8 h-8 py-2 px-4 rounded-full flex items-center justify-center" [ngClass]="{ 'bg-blue-200 text-blue-800': viewMode === 'grid' }" (click)="setViewMode('grid')"><i class="fa-solid fa-border-all"></i></button>
        <button title="Lista" class="bg-gray-200 hover:bg-gray-300 text-sm w-8 h-8 py-2 px-4 rounded-full flex items-center justify-center" [ngClass]="{ 'bg-blue-200 text-blue-800': viewMode === 'list' }" (click)="setViewMode('list')"><i class="fas fa-list"></i></button>
      </div>
    </div>
    @if (viewMode === 'grid') {
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        @for (ticket of tickets; track $index) {
          <div class="bg-white border shadow-md rounded-3xl p-6 w-96- h-auto">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-md font-semibold text-gray-800 flex items-center">
                <div title="{{ ticket.priority }}" class="w-3 h-3 rounded-full mr-2" [ngClass]="{
                  'bg-green-500': ticket.priority === 'Low',
                  'bg-yellow-500': ticket.priority === 'Medium',
                  'bg-orange-500': ticket.priority === 'High',
                  'bg-red-500': ticket.priority === 'Urgent'
                }"></div> 
                <span>Chamado #{{ ticket.id }}</span>
              </h3>
              <p class="text-xs text-gray-500">Aberto por</p>
            </div>
            <div class="mb-4">
              <div class="text-xs text-gray-600 mb-3 truncate">
                <span>{{ ticket.subject }}</span>
              </div>
              <div class="text-xs text-gray-600 space-y-2">
                <div class="flex justify-between">
                  <p><strong>Data de Abertura</strong></p>
                  <p>{{ ticket.createdAt }}</p>
                </div>
                <div class="flex justify-between">
                  <p><strong>Última atualização</strong></p>
                  <p>{{ ticket.updatedAt }}</p>
                </div>
                <div class="flex justify-between">
                  <p><strong>Responsável</strong></p>
                  <p>{{ ticket.assignees.length > 0 ? ticket.assignees[0].fullName + (ticket.assignees.length > 1 ? ', +' + (ticket.assignees.length - 1) : '') : 'Nenhum usuário atribuído' }}</p>
                </div>     
              </div>
            </div>
            <div class="flex space-x-2">
              <a routerLink="/ticket/{{ ticket.id }}" class="w-full text-center bg-green-100 hover:bg-green-200 text-xs text-green-900 py-2 px-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75">Responder</a>
              <a class="w-full text-center bg-blue-100 hover:bg-blue-200 text-xs text-blue-900 py-2 px-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75">Observar</a>
            </div>
          </div>
        }
      </div>
    }
    @else {
      <div class="grid grid-cols-[auto_auto_auto_1fr_auto_auto_auto_auto] w-full text-sm">
        <div class="h-[56px] flex items-center pl-1 font-semibold text-left border-b border-gray-200">
          <div class="w-10 h-10 flex justify-center items-center">
            <input
              type="checkbox"
              [(ngModel)]="allSelected"
              (change)="toggleAll($event)"
              class="w-4 h-4 text-blue-600 bg-gray-100 border border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600"
            />
          </div>    
        </div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Chamado</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Prioridade</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Assunto</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Data de Abertura</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Última Atualização</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Responsável</div>
        <div class="h-[56px] flex items-center px-4 font-semibold text-left border-b border-gray-200">Ações</div>
        @for (ticket of tickets; track $index) {
          <div class="h-[52px] flex items-center pl-1 border-b border-gray-200">
            <div class="w-10 h-10 flex justify-center items-center">
              <input
                type="checkbox"
                [(ngModel)]="ticket.selected"
                (change)="onTicketSelect(ticket)"
                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600"
              />
            </div>
          </div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 truncate">{{ ticket.id }}</div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 space-x-2 truncate">
            <div
              title="{{ ticket.priority }}"
              class="w-2 h-2 rounded-full"
              [ngClass]="{
                'bg-green-500': ticket.priority === 'Low',
                'bg-yellow-500': ticket.priority === 'Medium',
                'bg-orange-500': ticket.priority === 'High',
                'bg-red-500': ticket.priority === 'Urgent'
              }"
            ></div>
            <span>{{ ticket.priority }}</span>
          </div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 truncate"><a routerLink="/ticket/{{ ticket.id }}">{{ ticket.subject }}</a></div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 truncate">{{ ticket.createdAt  }}</div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 truncate">{{ ticket.updatedAt }}</div>
          <div class="h-[52px] flex items-center px-4 border-b border-gray-200 truncate">
            {{
              ticket.assignees.length > 0
                ? ticket.assignees[0].fullName +
                  (ticket.assignees.length > 1
                    ? ', +' + (ticket.assignees.length - 1)
                    : '')
                : 'Nenhum usuário atribuído'
            }}
          </div>
          <div class="h-[52px] flex items-center space-x-2 px-4 border-b border-gray-200 truncate">
            <a title="Responder" routerLink="/ticket/{{ ticket.id }}" class="w-4 h-4 flex justify-center items-center p-4 rounded-full cursor-pointer bg-green-200 text-green-600"><i class="fa-solid fa-comments"></i></a>
            <a title="Observar" class="w-4 h-4 flex justify-center items-center p-4 rounded-full cursor-pointer bg-blue-200 text-blue-600"><i class="fa-solid fa-eye"></i></a>
          </div>
        }
      </div>
    }
  </div>
</div>
<div>
  <phds-pagination
    [page]="page"
    [size]="size"
    [totalItems]="totalItems"
    [pageSizeOptions]="pageSizeOptions"
    (pageChange)="goToPage($event)"
    (sizeChange)="onPageSizeChange($event)"
  />
</div>
